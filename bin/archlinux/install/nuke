#!/usr/bin/env bash
# wipe everything on /dev/sda and add newand 
set -e

# ensure user is root
if [ "$(id -u)" != "0" ]; then
   exec sudo "$0" "$@" 
fi

# -Z            destroy GPT data structures
# -a            set alignment value to 2048
# -o            clear out all partition data
# /dev/sda      working partition
# -n            create two new partitions with 1st with size 512Mb and 2nd with size equal to the remaining disk space
# -t            partition type ef00 for EFI System and undefinded defaults to 8300 or linux filesystem

sgdisk -Z -a 2048 -o /dev/sda -n 1::+512M -n 2::: -t 1:ef00
