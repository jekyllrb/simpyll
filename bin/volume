#!/usr/bin/env bash
# change the volume up/down 5% or mute/unmute
#
# Usage:
#
#   volume up
#   volume down
#   volume toggle

set -e

newvolume() {
  display "Volume: $(amixer set Master $1 | grep -oPm1 '\d+(?=%)')"
}

display() {
  hh=$(xrandr | awk '{sub(",","",$10);print $10;exit}')
  h=200
  dzen2 -p 1 -y $[(hh-h)/2] -h $h -fn "-*-dejavu sans-*-*-*-*-$h-*-*-*-*-*-*-*" <<< $1
}

case "$1" in
  u|up)
    newvolume 5%+;;
  d|down)
    newvolume 5%-;;
  t|toggle)
    display "Sound: $(amixer set Master toggle | grep -oPm1 '(?<=\[)(on|off)(?=\])')";;
  *)
    exit 1;;
esac
