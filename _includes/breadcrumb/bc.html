<div class="desktop">
  <div class="breadcrumb-item">
    <li><a class="breadcrumb-home" href="{{site.baseurl}}"><i class="fa fa-home"></i></a></li>
    <div class="dropdown">
    <div class="subdirectory dropdown-content">
      {% assign page_url = page.url %}
      {% assign url_parts = page.url | replace: '/','-' | append: '@' | remove: '-@' | replace: '-','/' | split: '/' %}
      {% capture url_parts_size %}{{ url_parts | size }}{% endcapture %}
      {% capture rm %}{{ url_parts | last | append: '/' }}{% endcapture %}
      {% capture base_url %}{{ page.url | replace: rm, '' }}{% endcapture %}
      {% for node in site.pages %}
        {% assign node_url_parts = node.url | replace: '/','-' | append: '@' | remove: '-@' | replace: '-','/' | split: '/' %}
        {% capture node_url_rm %}{{ node.url | split: '/' | last | append: '/' }}{% endcapture %}
        {% capture node_url_base %}{{ node.url | replace: node_url_rm, '' }}{% endcapture %}
        {% if node_url_base == page.url %}
          {% if page.url != site.baseurl %}
            <li><a href="{{node.url}}">{{node.title }}</a></li>
          {% endif %}
        {% endif %}
      {% endfor %}
    </div>
    </div>
</div>
  {% capture url_parts %}{{ page.url | replace:'/'," " }}{% endcapture %} 
  {% capture num_parts %}{{ url_parts | number_of_words }}{% endcapture %}
  {% capture current_page %}{{ site.baseurl }}{{ page.url }}{% endcapture %}
  {% assign page_base = page.url | split: '/' | last %}
  {% assign previous="" %}
  {% for unused in (1..num_parts) %}
    {% capture first_word %}{{ url_parts | truncatewords:1 | remove:"..." }}{% endcapture %}
    {% capture previous %}{{ previous }}/{{ first_word }}{% endcapture %}
  <div class="breadcrumb-item">
    {% if first_word == page_base %}
      {% if page.url == '/' %}
  <div class="dropdown">
  <i class="fa fa-home"></i>
{%else%}
  <div class="dropdown">
  <div class="subdirectories dropbtn">/ {{ first_word | replace: '-',' ' }}</div>
{%endif%}
  <div class="subdirectory dropdown-content">
  {% assign page_url = page.url %}
  {% assign url_parts = page.url | replace: '/','-' | append: '@' | remove: '-@' | replace: '-','/' | split: '/' %}
  {% capture url_parts_size %}{{ url_parts | size }}{% endcapture %}
  {% capture rm %}{{ url_parts | last | append: '/' }}{% endcapture %}
  {% capture base_url %}{{ page.url | replace: rm, '' }}{% endcapture %}
  {% for node in site.pages %}
  {% assign node_url_parts = node.url | replace: '/','-' | append: '@' | remove: '-@' | replace: '-','/' | split: '/' %}
  {% capture node_url_rm %}{{ node.url | split: '/' | last | append: '/' }}{% endcapture %}
  {% capture node_url_base %}{{ node.url | replace: node_url_rm, '' }}{% endcapture %}
  {% if node_url_base == page_url %}
    <a href="{{node.url}}">{{node.title }}</a>
  {% endif %}
  {% endfor %}
  </div>
</div>
    {% else %}
      <div class="breadcrumb-item-link"><a href="{{previous}}">{{ first_word | replace: '-',' '}}</a></div> 
    {% endif %}
    {% capture url_parts %}{{ url_parts | remove_first:first_word }}{% endcapture %}
  </div> 
  {% endfor %}
</div>
